

<h1>Related term groups</h1>

<p>You can manipulate the data, only columns with a custom header defined are saved. On submit, the data is inserted as a Group with Concept(s).</p>


<div class="block full">
    <div class="align-left">
        <label>Neo4j username</label>
        <input type="text" class="form-control" placeholder="Enter username" ng-model="neo4j.username">
    </div>

    <div class="align-mid">
        <label>Password</label>
        <input type="password" class="form-control" placeholder="Password" ng-model="neo4j.password">
    </div>
</div>


<div class="row block ng-cloak">
    <p ng-show="msg" class="green">
        {{ msg }}
    </p>

    <div ng-show="error">
        <p class="danger">Error:</p>
        <pre>{{ error | json }}</pre>
    </div>
</div>

<div class="row">
    <h3>Use wikipedia info or start from scratch</h3>

    <div class="align-left inline">
        <input type="text" class="align-left" placeholder="Wikipedia url to extract info from" ng-model="url">

        <button type="button" class="blue" ng-click="extract(url)">
            Extract data
        </button>
    </div>

    <div class="align-mid">
        <button type="button" class="green align-right" ng-click="custom()">
            Custom group
        </button>
    </div>
</div>


<div class="groups">

    <div class="block">
        <div class="row">
            <input type="hidden" ng-model="meta.url">

            <div class="align-left">
                <label>Group name</label>
                <input type="text" class="form-control" placeholder="Group name" ng-model="meta.name" required>
            </div>

            <div class="align-mid">
                <label>Abbreviation of name</label>
                <input type="text" class="form-control" placeholder="Abbreviation of name" ng-model="meta.abbr">
            </div>
        </div>

        <div class="row">
            <label>Description</label>
            <textarea class="full" ng-model="meta.description" placeholder="Short description"></textarea>
        </div>
    </div>

    <div ng-if="validated_tables" class="ng-cloak">

        <div class="block preview-tables" ng-repeat="(index, table) in validated_tables track by index" ng-if="!table._delete">
            <div class="row spaced">
                <h4 class="align-left">Table {{ ::index }}</h4>

                <div class="align-right">
                    <div class="align-left" style="margin-right:14px" title="This will add another column, filled with the CUI codes based on the entries in a given column" ng-show="! isEmpty(table.header)">
                        <select class="form-control" placeholder="Calculate CUI codes" ng-model="_cui_col_index">
                          <option ng-repeat="(k, v) in table.header" value="{{ k }}">{{ v }}</option>
                        </select>

                        <button type="button" class="btn btn-primary" ng-click="getCUI(table, _cui_col_index)">
                            Find CUI codes
                        </button>
                    </div>

                    <button type="button" ng-click="removeTable(index)" class="align-right danger">
                        Delete table
                    </button>
                </div>
            </div>

            <table>
                <!-- Allow user defined header -->
                <tr>
                    <th class="small"></th>

                    <th ng-repeat="(col_index, _) in table.rows[0] track by col_index" class="text-center" ng-if="col_index != 'meta'">
                        <input
                            type="text"
                            ng-model="table['header'][col_index]"
                            placeholder="Header column {{ col_index }}">

                        <button type="button" class="danger" ng-click="removeColumn(table, col_index)">X</button>
                    </th>

                    <th>
                        <button type="button" ng-click="addColumn(table)" class="align-left">
                            + Column
                        </button>
                    </th>
                </tr>

                <tr ng-repeat="row in table.rows track by $index">
                    <td class="small">
                        <input type="checkbox" class="checkbox" ng-model="row['meta'].checked">
                    </td>

                    <td ng-repeat="(col_index, col) in row track by col_index" ng-if="col_index != 'meta'">
                        <input type="text" ng-value='col' ng-model="row[col_index]">
                    </td>

                    <td></td>
                </tr>

                <tr class="last">
                    <td></td>
                    <td>
                        <button type="button" ng-click="addRow(table)">
                            Add row
                        </button>
                    </td>
                </tr>
            </table>

            <div class="row parse">
                <label>Paste data here</label>
                <textarea class="full" ng-model="__data" placeholder="Parse data for new rows"></textarea>

                <button type="button" class="blue" ng-click="parseForRows(__data, table); __data=''; ">
                    Parse rows
                </button>
            </div>
        </div>

        <div class="row">
            <button type="submit" class="navy align-right" id="submit" ng-click="submit(neo4j, meta, validated_tables)">Submit</button>
        </div>
    </div>
</div>


<link href="css/related.css" rel="stylesheet">